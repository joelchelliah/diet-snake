@use "sass:color";

$tile-border: 0.125rem;
$tile-size: 1rem;
$row-height: calc($tile-size + 2 * $tile-border);

$snake-head-color: #922;
$snake-tail-color: #d66;

%tile-base {
  border: $tile-border solid;
  width: $tile-size;
  height: $tile-size;
}

@mixin colored-tile($color, $darken: -50%, $saturate: 50%) {
  @extend %tile-base;

  $lighter: color.scale($color, $lightness: 50%);
  $darker: color.scale($color, $lightness: $darken);
  $highlight: color.scale($lighter, $saturation: $saturate);
  $shading: color.scale($darker, $saturation: -50%);

  background-color: $color;
  border-color: $highlight $shading $shading $highlight;
}

@mixin rotate($degrees) {
  -webkit-transform: rotate($degrees);
  -moz-transform: rotate($degrees);
  -ms-transform: rotate($degrees);
  -o-transform: rotate($degrees);
  transform: rotate($degrees);
}

@mixin bulging-tile($bulge, $brighten, $color: $snake-tail-color) {
  $bulgeColor: color.scale($color, $lightness: $brighten);

  @include colored-tile($bulgeColor);

  position: relative;
  width: calc($tile-size + $bulge);
  height: calc($tile-size + $bulge);
  right: calc($bulge / 2);
  bottom: calc($bulge / 2);
}

.row {
  display: flex;
  flex-direction: row;
  height: $row-height;
}

/* Empty (non-wall) tile, and also the background tile behind all other tiles. */
.background-tile {
  display: inline-block;

  @include colored-tile(#ddf, -20%);
}

.tile {
  display: block;
  margin: -$tile-border;

  &.wall {
    @include colored-tile(#aaa, -60%, 0%);
  }

  &.snake {
    &.head {
      @include colored-tile($snake-head-color);

      &.bulge-1 {
        @include bulging-tile(0.75rem, 30%, $snake-head-color);
      }

      &.bulge-2 {
        @include bulging-tile(0.5rem, 15%, $snake-head-color);
      }
    }

    &.tail {
      @include colored-tile($snake-tail-color);

      &.bulge-1 {
        // 5
        @include bulging-tile(0.3125rem, 10%);

        &.clockwise {
          @include rotate(5deg);
        }

        &.counter-clockwise {
          @include rotate(-5deg);
        }
      }

      &.bulge-2 {
        // 10
        @include bulging-tile(0.625rem, 20%);

        &.clockwise {
          @include rotate(10deg);
        }

        &.counter-clockwise {
          @include rotate(-10deg);
        }
      }

      &.bulge-3 {
        // 8
        @include bulging-tile(0.5rem, 15%);

        &.clockwise {
          @include rotate(6deg);
        }

        &.counter-clockwise {
          @include rotate(-6deg);
        }
      }

      &.bulge-4 {
        // 6
        @include bulging-tile(0.375rem, 10%);

        &.clockwise {
          @include rotate(4deg);
        }

        &.counter-clockwise {
          @include rotate(4deg);
        }
      }
    }

    &.dead {
      @include colored-tile(#753);
    }
  }

  &.pill {
    position: relative;

    &.green {
      @include colored-tile(#5b5);
    }

    &.blue {
      @include colored-tile(#77f);
    }

    &.yellow {
      @include colored-tile(#dd5);
    }

    &.pink {
      @include colored-tile(#d6d);
    }

    &.teal {
      @include colored-tile(#4cc);
    }
  }
}
